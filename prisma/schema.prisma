datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

model DirectChat {
  id        String   @id @default(uuid())
  sender    String
  receiver  String
  message   String
  createdAt DateTime @default(now())
  User1     User     @relation("user1", fields: [sender], references: [username])
  User2     User     @relation("user2", fields: [receiver], references: [username])
}

model GroupChat {
  id        String   @id @default(uuid())
  groupId   String
  group     Group    @relation(fields: [groupId], references: [id])
  message   String
  createdAt DateTime @default(now())
  username  String
  User      User     @relation(fields: [username], references: [username])
}

model User {
  username     String       @id @unique
  icon_id      Int          @default(0)
  password     String
  chats        GroupChat[]
  groups       Group[]
  adminOf      Group[]      @relation("admin")
  directChats1 DirectChat[] @relation("user1")
  directChats2 DirectChat[] @relation("user2")
}

model Group {
  id            String      @id @default(uuid())
  name          String
  adminUsername String
  admin         User        @relation("admin", fields: [adminUsername], references: [username])
  members       User[]
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt()
  Chat          GroupChat[]
}
